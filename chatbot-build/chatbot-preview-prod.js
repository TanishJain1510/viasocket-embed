(()=>{let e=null,t=!1;const n="interfaceData";let o={};const i=f("b1357e23-2fc6-4dc3-855a-7a213b1fa100"),a=f("91ee0bff-cfe3-4e2d-64e5-fadbd9a3a200");let d=document.getElementById("chatbot-main-script");const c=document.createElement("div");c.id="interfaceEmbed";const s=document.createElement("img");s.id="popup-interfaceEmbed",s.className="chatbot-icon-interfaceEmbed",s.alt="Ask Ai",s.src=a,s.style.visibility="hidden",c.appendChild(s);const l=document.createElement("span");l.id="popup-interfaceEmbed-text",c.appendChild(l),document.body.appendChild(c);var r=document.createElement("link");r.id="chatbotEmbed-style",r.rel="stylesheet",r.type="text/css",r.href="https://chatbot-embed.viasocket.com/style-prod.css",document.head.appendChild(r);const m=(e={})=>{o={...o,...e},p(e)},p=e=>{e.iconColor&&(document.getElementById("popup-interfaceEmbed").src="dark"===e.iconColor?i:a),!0!==e.fullScreen&&"true"!==e.fullScreen||document.getElementById("iframe-parent-container")?.classList.add("full-screen-interfaceEmbed"),!1!==e.fullScreen&&"false"!==e.fullScreen||document.getElementById("iframe-parent-container")?.classList.remove("full-screen-interfaceEmbed"),"hideIcon"in e&&document.getElementById("interfaceEmbed")&&(document.getElementById("interfaceEmbed").style.display=!0===e.hideIcon||"true"===e.hideIcon?"none":"unset"),"hideCloseButton"in e&&document.getElementById("close-button-interfaceEmbed")&&(document.getElementById("close-button-interfaceEmbed").style.display=!0===e.hideCloseButton||"true"===e.hideCloseButton?"none":"unset")};function u(){d?(["interfaceId","embedToken","threadId","bridgeName","variables","onOpen","onClose","iconColor","className","style","environment","fullScreen","hideCloseButton","hideIcon","parentId"].forEach((e=>{d.hasAttribute(e)&&(o[e]=d.getAttribute(e))})),console.log("loop pura chal gya hai")):console.log("Script tag not found")}function f(e){return`https://imagedelivery.net/Vv7GgOGQbSyClWJqhyP0VQ/${e}/public`}u(),new MutationObserver((function(e,t){for(const n of e)if("childList"===n.type){for(const e of n.addedNodes)"chatbot-main-script"===e.id&&(console.log("Script tag added"),d=document.getElementById("chatbot-main-script"),u());for(const e of n.removedNodes)if("chatbot-main-script"===e.id){console.log("Script tag removed, performing cleanup...");const e=document.getElementById("iframe-parent-container"),n=document.getElementById("interfaceEmbed"),o=document.getElementById("chatbotEmbed-style");n&&(console.log("removing iframe"),n.remove()),e&&(console.log("removing button"),e.remove()),o&&(console.log("removing style tag"),o.remove()),t.disconnect()}}})).observe(document.head,{childList:!0}),closeChatbot=function(){const e=document.getElementById("iframe-parent-container");if("block"===e?.style?.display)return e.style.transition="opacity 0.2s ease-in-out",e.style.opacity=0,void setTimeout((()=>{e.style.display="none",document.body.style.overflow="auto",document.getElementById("interfaceEmbed")&&(document.getElementById("interfaceEmbed").style.display=o?.hideIcon?"none":"unset"),window.parent?.postMessage({type:"close",data:{}},"*"),v.contentWindow?.postMessage({type:"close",data:{}},"*")}),200)};const y=setTimeout((()=>{window.removeEventListener("message",h),console.log("Event listener removed after 60 seconds")}),6e4);function h(t){const{type:o}=t.data;"interfaceLoaded"===o&&(e&&(document.getElementById("iframe-component-interfaceEmbed").contentWindow.postMessage({type:n,data:e},"*"),e=null),window.removeEventListener("message",h),clearTimeout(y))}let g=null,b={type:"popup",height:"100",heightUnit:"%",width:"100",widthUnit:"%",buttonName:"",themeColor:"#000000"},E="Via socket",w="Chatbot",C="popup";loadChatbotEmbed=async function(){window.addEventListener("message",(function(e){const{type:t,data:n}=e.data;"chatbotConfig"===t&&(b.themeColor!=n.themeColor&&document.getElementById("iframe-component-interfaceEmbed")?.contentWindow?.postMessage({type:"themeChange",themeColor:n.themeColor},"*"),b=n,updateConfig(b))}),!1),document.getElementById("iframe-component-interfaceEmbed").src="https://chatbot.gtwy.ai/chatbotpreview"},updateConfig=function(e={}){const t=document.getElementById("interfaceEmbed"),n=document.getElementById("popup-interfaceEmbed-text"),o=document.getElementById("popup-interfaceEmbed");e&&(e.title&&(E=e.title),e.buttonName?(w=e.buttonName,n.innerText=w,t.classList.add("show-bg-color"),o.style.visibility="hidden"):(n.innerText="",t?.classList.remove("show-bg-color"),o.style.visibility="visible"),e.iconUrl?(o.src=e.iconUrl,t?.classList.remove("show-bg-color"),n.innerText="",o.style.visibility="visible"):o.src=a,e.type&&(document.getElementById("iframe-parent-container")?.classList.remove(`${C}-parent-container`),t?.classList.remove(`${C}-interfaceEmbed`),C=e.type)),document.getElementById("iframe-parent-container")?.classList.add(`${C}-parent-container`),t?.classList.add(`${C}-interfaceEmbed`),"all_available_space"===C?(document.getElementById("iframe-parent-container").style.height="100%",document.getElementById("iframe-parent-container").style.width="100%"):(document.getElementById("iframe-parent-container").style.height=`${e?.height}${e?.heightUnit||""}`||"70vh",document.getElementById("iframe-parent-container").style.width=`${e?.width}${e?.widthUnit||""}`||"40vw")};const I=function(e=o.parentId||"",n=t){if(!n){if(window.addEventListener("message",h),g||(g=document.createElement("div"),g.id="iframe-parent-container",g.className="popup-parent-container",g.style.display="none",g.innerHTML='\n        <button id=\'close-button-interfaceEmbed\' onclick="closeChatbot()">\n          <svg width="35px" height="35px" viewBox="-3.2 -3.2 38.40 38.40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" fill="#000000">\n            <g id="SVGRepo_bgCarrier" stroke-width="0" transform="translate(4.640000000000001,4.640000000000001), scale(0.71)">\n              <rect x="-3.2" y="-3.2" width="38.40" height="38.40" rx="0" fill="#ffffff" strokewidth="0"></rect>\n            </g>\n            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>\n            <g id="SVGRepo_iconCarrier">\n              <title>cross-square</title>\n              <desc>Created with Sketch Beta.</desc>\n              <defs></defs>\n              <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n                <g id="Icon-Set-Filled" sketch:type="MSLayerGroup" transform="translate(-206.000000, -1037.000000)" fill="#000000">\n                  <path d="M226.95,1056.54 C227.34,1056.93 227.34,1057.56 226.95,1057.95 C226.559,1058.34 225.926,1058.34 225.536,1057.95 L222,1054.41 L218.464,1057.95 C218.074,1058.34 217.441,1058.34 217.05,1057.95 C216.66,1057.56 216.66,1056.93 217.05,1056.54 L220.586,1053 L217.05,1049.46 C216.66,1049.07 216.66,1048.44 217.05,1048.05 C217.441,1047.66 218.074,1047.66 218.464,1048.05 L222,1051.59 L225.536,1048.05 C225.926,1047.66 226.559,1047.66 226.95,1048.05 C227.34,1048.44 227.34,1049.07 226.95,1049.46 L223.414,1053 L226.95,1056.54 L226.95,1056.54 Z M234,1037 L210,1037 C207.791,1037 206,1038.79 206,1041 L206,1065 C206,1067.21 207.791,1069 210,1069 L234,1069 C236.209,1069 238,1067.21 238,1065 L238,1041 C238,1038.79 236.209,1037 234,1037 L234,1037 Z" id="cross-square" sketch:type="MSShapeGroup"></path>\n                </g>\n              </g>\n            </g>\n          </svg>\n        </button>\n       <iframe id="iframe-component-interfaceEmbed" title="iframe" sandbox="allow-scripts allow-same-origin allow-popups"></iframe>\n      '),e){const t=document.getElementById(e);t&&(t.style.position="relative",t.appendChild(g))}else document.getElementById("interface-chatbot")?document.getElementById("interface-chatbot").appendChild(g):document.body.appendChild(g);t=!0,m({...o}),loadChatbotEmbed()}};document.addEventListener("DOMContentLoaded",I),document?.body&&I();const v=document.getElementById("iframe-component-interfaceEmbed");v&&(v.onload=function(){v.contentWindow?.postMessage({type:n,data:e},"*")}),SendDataToChatbot=function(t){if("parentId"in t){const e=o.parentId;if(e!==t.parentId){if(e){const t=document.getElementById(e);t&&g&&t.contains(g)&&t.removeChild(g)}else g&&document.body.contains(g)&&document.body.removeChild(g);m({parentId:t.parentId}),I(t.parentId,!1)}}"hideCloseButton"in t&&m({hideCloseButton:t.hideCloseButton||!1}),"hideIcon"in t&&m({hideIcon:t.hideIcon||!1}),t.iconColor&&m({iconColor:t.iconColor||"dark"}),!0!==t.fullScreen&&"true"!==t.fullScreen||m({fullScreen:t.fullScreen}),!1!==t.fullScreen&&"false"!==t.fullScreen||m({fullScreen:t.fullScreen}),t&&v&&(e=t,v.contentWindow?.postMessage({type:n,data:t},"*")),t.askAi&&v.contentWindow?.postMessage({type:"askAi",data:t||{}},"*")},openChatbot=function(){if(window.parent?.postMessage({type:"open",data:{}},"*"),v.contentWindow?.postMessage({type:"open",data:{}},"*"),document.getElementById("interfaceEmbed")&&document.getElementById("iframe-parent-container")){document.getElementById("interfaceEmbed").style.display="none";const e=document.getElementById("iframe-parent-container");e.style.display="block",e.style.opacity=0,e.style.transition="opacity 0.3s ease-in-out",requestAnimationFrame((()=>{e.style.opacity=1})),document.body.style.overflow="hidden"}},reloadChats=function(){v.contentWindow?.postMessage({type:"refresh",reload:!0},"*")},askAi=function(e){v.contentWindow?.postMessage({type:"askAi",data:e||""},"*")},document.getElementById("interfaceEmbed")?.addEventListener("click",(()=>{window.openChatbot()}))})();