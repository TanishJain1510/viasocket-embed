(()=>{const e="https://face.viasocket.com/i";var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="https://interface-embed.viasocket.com/style-prod.css",document.head.appendChild(t);var n=document.createElement("button");let o="",a="Via socket",i="open";n.setAttribute("type","button"),n.setAttribute("class","close-button"),n.setAttribute("id","close-button"),n.textContent="close",n.style.position="absolute";let c="popup";n.style.top="2px",n.style.right="2px",n.addEventListener("click",(()=>{if("block"===document.getElementById("iframe-parent-container")?.style?.display)return document.getElementById("iframe-parent-container").style.display="none",document.body.style.overflow="auto",document.getElementById("interfaceEmbed").style.display="unset",void window.parent?.postMessage({type:"close",data:{}},"*")})),document.getElementById("iframe-parent-container")?.appendChild(n),InitializeInterface=function(){iframeController()},SendDataToInterface=function(e){const t="interfaceData";document.getElementById("iframe-component").onload=function(){document.getElementById("iframe-component").contentWindow?.postMessage({type:t,data:e},"*")},e&&document.getElementById("iframe-component")&&document.getElementById("iframe-component").contentWindow?.postMessage({type:t,data:e},"*")},loadViasocketEmbed=async function(){const t=document.getElementById("interface-main-script")?.getAttribute("embedToken");let n=`${e}?`,d={};if(t)d={method:"POST",headers:{"Content-Type":"application/json",Authorization:t}};else{const e=document.getElementById("interface-main-script")?.getAttribute("interface_id");e&&(d={method:"POST",body:JSON.stringify({isAnonymousUser:!0,interface_id:e}),headers:{"Content-Type":"application/json"}})}fetch("https://flow-api.viasocket.com/interfaces/loginuser",d).then((async e=>await e.json())).then((t=>{o=t?.data?.config,n=n.concat(`interfaceDetails=${JSON.stringify(t.data)}`);const d=document.getElementById("iframe-component")?.src?.split("?"),m=d?.[0];m!==e&&document.getElementById("iframe-component")&&(document.getElementById("iframe-component").src=n),o&&(o.title&&(a=o.title),o.buttonName&&(i=o.buttonName,document.getElementById("interfaceEmbed").innerText=i),o.type&&(document.getElementById("iframe-parent-container").classList.remove(`${c}-parent-container`),document.getElementById("interfaceEmbed").classList.remove(`${c}-interfaceEmbed`),c=o.type)),document.getElementById("iframe-parent-container").classList.add(`${c}-parent-container`),document.getElementById("interfaceEmbed").classList.add(`${c}-interfaceEmbed`),"all_space"===c?(document.getElementById("iframe-parent-container").style.height="100%",document.getElementById("iframe-parent-container").style.width="100%"):(document.getElementById("iframe-parent-container").style.height=`${o?.height}${o?.heightUnit||""}`||"70vh",document.getElementById("iframe-parent-container").style.width=`${o?.width}${o?.widthUnit||""}`||"40vw")})).catch((e=>{console.log("Fetch error:",e)}))},iframeController=function(){document.getElementById("interfaceEmbed")&&document.getElementById("iframe-parent-container")&&(document.getElementById("interfaceEmbed").style.display="none",document.getElementById("iframe-parent-container").style.display="block",document.getElementById("title").innerText=a||"Viasocket",document.body.style.overflow="hidden")},loadViasocketEmbed(),document.getElementById("interfaceEmbed").addEventListener("click",(()=>{window.InitializeInterface()}))})();